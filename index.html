<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login Page</title>
</head>
<body>

<h2>Enter Download Code</h2>
<input id="code" placeholder="Enter your code">
<button onclick="login()">Login</button>
<p id="msg"></p>

<script>
// ===== GOOGLE SHEET JSON =====
const SHEET_JSON = "https://docs.google.com/spreadsheets/d/1dcKugmmNcr4Uu4RZFOP8PxZSRt-nQpqQUlrF4P9ck8Q/gviz/tq?tqx=out:json";

function login(){
  const code = document.getElementById("code").value.trim();
  const msg = document.getElementById("msg");

  if(!code){
    msg.innerText = "Please enter code!";
    return;
  }

  fetch(SHEET_JSON)
  .then(res => res.text())
  .then(txt => {
    const json = JSON.parse(txt.substring(47).slice(0,-2));
    const rows = json.table.rows;

    let vipLink = "";
    let freeLink = "";
    let found = false;

    for(let r of rows){
      const c = r.c;
      const sheetCode = c[0] ? c[0].v : "";
      const sheetVip  = c[1] ? c[1].v : "";
      const sheetFree = c[2] ? c[2].v : "";

      if(sheetCode === code){
        vipLink = sheetVip;
        freeLink= sheetFree;
        found = true;
        break;
      }
    }

    if(!found){
      msg.innerText = "Invalid Code ❌";
      return;
    }

    if(code.toUpperCase().startsWith("FREE")){
      msg.innerText = "Free Access ✔ Redirecting...";
      setTimeout(()=> location.href = freeLink, 1000);
    } else {
      msg.innerText = "VIP Access ✔ Redirecting...";
      setTimeout(()=> location.href = vipLink, 1000);
    }

  });
}
</script>

</body>
</html>
